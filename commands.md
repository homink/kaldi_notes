# Kaldi Commands
A series of command examples described in the kaldi tutorial from egs/librispeech/s5

## Path Configuration
```
export KALDI_ROOT=`pwd`/../../..
export PATH=$PWD/utils/:$KALDI_ROOT/tools/openfst/bin:$PWD:$PATH
[ ! -f $KALDI_ROOT/tools/config/common_path.sh ] && echo >&2 "The standard file $KALDI_ROOT/tools/config/common_path.sh is not present -> Exit!" && exit 1
. $KALDI_ROOT/tools/config/common_path.sh
export LC_ALL=C
```

## Data Configuration

### Required folders

Give such [data files](http://kaldi-asr.org/doc/data_prep.html) as data/*/wav.scp | utt2spk | text | spk2utt | spk2gender, the following folders are created by such scripts [local/prepare_dict.sh](https://github.com/kaldi-asr/kaldi/blob/master/egs/librispeech/s5/local/prepare_dict.sh), [utils/prepare_lang.sh](https://github.com/kaldi-asr/kaldi/blob/master/egs/wsj/s5/utils/prepare_lang.sh), [steps/make_mfcc.sh](https://github.com/kaldi-asr/kaldi/blob/master/egs/wsj/s5/steps/make_mfcc.sh), and [steps/compute_cmvn_stats.sh](https://github.com/kaldi-asr/kaldi/blob/master/egs/wsj/s5/steps/compute_cmvn_stats.sh).

```
>> ls data/train_clean_100
cmvn.scp   spk2gender  split20  text     utt2spk
feats.scp  spk2utt     split30  utt2dur  wav.scp

>> ls data/lang_nosp
L.fst  L_disambig.fst  oov.int  oov.txt  phones  phones.txt  topo  words.txt
```

### Snippets

```
>> head -n 1 data/train_clean_100/*
==> data/train_clean_100/cmvn.scp <==
103-1240 /home/kwon/kaldi/egs/librispeech/s5/mfcc/cmvn_train_clean_100.ark:9

==> data/train_clean_100/feats.scp <==
103-1240-0000 /home/kwon/kaldi/egs/librispeech/s5/mfcc/raw_mfcc_train_clean_100.1.ark:14

==> data/train_clean_100/spk2gender <==
103-1240 f

==> data/train_clean_100/spk2utt <==
103-1240 103-1240-0000 103-1240-0001 103-1240-0002 103-1240-0003 103-1240-0004 103-1240-0005 103-1240-0006 103-1240-0007 103-1240-0008 103-1240-0009 103-1240-0010 103-1240-0011 103-1240-0012 103-1240-0013 103-1240-0014 103-1240-0015 103-1240-0016 103-1240-0017 103-1240-0018 103-1240-0019 103-1240-0020 103-1240-0021 103-1240-0022 103-1240-0023 103-1240-0024 103-1240-0025 103-1240-0026 103-1240-0027 103-1240-0028 103-1240-0029 103-1240-0030 103-1240-0031 103-1240-0032 103-1240-0033 103-1240-0034 103-1240-0035 103-1240-0036 103-1240-0037 103-1240-0038 103-1240-0039 103-1240-0040 103-1240-0041 103-1240-0042 103-1240-0043 103-1240-0044 103-1240-0045 103-1240-0046 103-1240-0047 103-1240-0048 103-1240-0049 103-1240-0050 103-1240-0051 103-1240-0052 103-1240-0053 103-1240-0054 103-1240-0055 103-1240-0056 103-1240-0057

==> data/train_clean_100/text <==
103-1240-0000 CHAPTER ONE MISSUS RACHEL LYNDE IS SURPRISED MISSUS RACHEL LYNDE LIVED JUST WHERE THE AVONLEA MAIN ROAD DIPPED DOWN INTO A LITTLE HOLLOW FRINGED WITH ALDERS AND LADIES EARDROPS AND TRAVERSED BY A BROOK

==> data/train_clean_100/utt2dur <==
103-1240-0000 14.085

==> data/train_clean_100/utt2spk <==
103-1240-0000 103-1240

==> data/train_clean_100/wav.scp <==
103-1240-0000 flac -c -d -s /DATA/speech-data/LibriSpeech/LibriSpeech/train-clean-100/103/1240/103-1240-0000.flac |
```
```
>> head -n 5 data/lang_nosp/*
==> data/lang_nosp/oov.int <==
3

==> data/lang_nosp/oov.txt <==
<UNK>

==> data/lang_nosp/phones <==
head: error reading ‘data/lang_nosp/phones’: Is a directory

==> data/lang_nosp/phones.txt <==
<eps> 0
SIL 1
SIL_B 2
SIL_E 3
SIL_I 4

==> data/lang_nosp/topo <==
<Topology>
<TopologyEntry>
<ForPhones>
11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346
</ForPhones>

==> data/lang_nosp/words.txt <==
<eps> 0
!SIL 1
<SPOKEN_NOISE> 2
<UNK> 3
A 4
```

### Feature data access
```
>> head -n 2 data/train_clean_100/wav.scp
103-1240-0000 flac -c -d -s /DATA/speech-data/LibriSpeech/LibriSpeech/train-clean-100/103/1240/103-1240-0000.flac |
103-1240-0001 flac -c -d -s /DATA/speech-data/LibriSpeech/LibriSpeech/train-clean-100/103/1240/103-1240-0001.flac |

>> head -n 2 mfcc/raw_mfcc_train_clean_100.1.scp
103-1240-0000 /home/kwon/kaldi/egs/librispeech/s5/mfcc/raw_mfcc_train_clean_100.1.ark:14
103-1240-0001 /home/kwon/kaldi/egs/librispeech/s5/mfcc/raw_mfcc_train_clean_100.1.ark:18444

>> copy-feats ark:mfcc/raw_mfcc_train_clean_100.1.ark ark,t:- | head -n 3
copy-feats ark:mfcc/raw_mfcc_train_clean_100.1.ark ark,t:-
103-1240-0000  [
  58.67462 -15.60611 2.184004 7.542768 5.631777 8.630089 5.84442 9.01421 9.290709 3.775272 5.036974 8.85286 5.091539
  58.98494 -15.7387 1.309692 10.23859 7.881817 6.302338 4.503093 18.77525 14.13883 5.806011 -0.1769905 4.689496 9.476963

>> copy-feats scp:mfcc/raw_mfcc_train_clean_100.1.scp ark,t:- | head -n 3
copy-feats scp:mfcc/raw_mfcc_train_clean_100.1.scp ark,t:-
103-1240-0000  [
  58.67462 -15.60611 2.184004 7.542768 5.631777 8.630089 5.84442 9.01421 9.290709 3.775272 5.036974 8.85286 5.091539
  58.98494 -15.7387 1.309692 10.23859 7.881817 6.302338 4.503093 18.77525 14.13883 5.806011 -0.1769905 4.689496 9.476963  

>> head -n 10 mfcc/raw_mfcc_train_clean_100.1.scp | tail -1 | copy-feats scp:- ark,t:- | head -n 3
copy-feats scp:- ark,t:-
103-1240-0009  [
  69.15156 -23.55809 -17.40676 19.012 2.493718 2.018547 -6.833332 27.28095 16.73519 -11.01196 11.66684 11.5174 4.338723
  69.89393 -24.24755 -23.60734 18.83963 -4.45289 -7.504683 -3.681408 27.28095 35.15164 2.229705 4.515954 12.5211 10.81758
```

## Model Component Review

### L.fst

```
>> fstprint --isymbols=data/lang_nosp/phones.txt --osymbols=data/lang_nosp/words.txt data/lang_nosp/L.fst | head
0       1       <eps>   <eps>   0.693147182
0       1       SIL     <eps>   0.693147182
1       2       SIL_S   !SIL    0.693147182
1       1       SIL_S   !SIL    0.693147182
1       2       SPN_S   <SPOKEN_NOISE>  0.693147182
1       1       SPN_S   <SPOKEN_NOISE>  0.693147182
1       2       SPN_S   <UNK>   0.693147182
1       1       SPN_S   <UNK>   0.693147182
1       2       AH0_S   A       0.693147182
1       1       AH0_S   A       0.693147182

>> gmm-copy --binary=false exp/mono/0.mdl - | head -n 10
gmm-copy --binary=false exp/mono/0.mdl -
<TransitionModel>
<Topology>
<TopologyEntry>
<ForPhones>
11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346
</ForPhones>
<State> 0 <PdfClass> 0 <Transition> 0 0.75 <Transition> 1 0.25 </State>
<State> 1 <PdfClass> 1 <Transition> 1 0.75 <Transition> 2 0.25 </State>
<State> 2 <PdfClass> 2 <Transition> 2 0.75 <Transition> 3 0.25 </State>
<State> 3 </State>
```

### Tree

```
>> copy-tree --binary=false exp/mono/tree - | head -n 10
copy-tree --binary=false exp/mono/tree -
LOG (copy-tree[5.2.57~1391-97922]:main():copy-tree.cc:55) Copied tree
ContextDependency 1 0 ToPdf SE 0 [ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 ]
{ SE 0 [ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 ]
{ SE 0 [ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 ]
{ SE 0 [ 1 2 3 4 5 6 7 8 9 10 ]
{ SE 0 [ 1 2 3 4 5 ]
{ TE -1 5 ( CE 0 CE 1 CE 2 CE 3 CE 4 )
TE -1 5 ( CE 5 CE 6 CE 7 CE 8 CE 9 )
}
SE 0 [ 11 12 13 14 ]
{ TE -1 3 ( CE 10 CE 11 CE 12 )
```

### Phone alignment

```
>> copy-int-vector 'ark:gunzip -c exp/mono/ali.1.gz|' ark,t:- | head -n 2
copy-int-vector 'ark:gunzip -c exp/mono/ali.1.gz|' ark,t:-
103-1240-0015 4 1 1 1 1 1 1 1 1 16 15 15 18 17 17 17 17 17 17 17 1382 1381 1384 1386 1124 1123 1123 1126 1128 1838 1840 1842 2066 2065 2068 2067 2067 2070 2069 2069 2069 2069 956 958 960 1958 1957 1960 1959 1962 1961 1586 1585 1585 1585 1588 1590 332 334 333 336 335 1790 1789 1789 1789 1789 1789 1789 1789 1792 1791 1794 308 310 312 1550 1552 1554 1148 1150 1152 1151 1151 1151 302 301 301 304 303 303 303 306 305 305 305 1226 1225 1228 1227 1227 1227 1230 338 340 342 341 341 1562 1564 1563 1566 1565 1628 1627 1630 1632 182 181 181 181 181 181 181 181 181 184 183 183 186 2066 2065 2065 2068 2067 2067 2067 2067 2067 2067 2070 956 958 960 1838 1837 1840 1839 1842 2060 2059 2062 2061 2064 2063 2063 638 637 640 639 639 639 642 641 1082 1084 1086 962 964 966 965 1562 1564 1566 338 337 337 340 342 308 310 312 950 952 954 953 1970 1972 1971 1974 2162 2161 2164 2166 2165 2165 188 187 187 187 187 190 189 192 191 191 1574 1573 1573 1573 1576 1578 1577 1628 1627 1630 1629 1629 1632 1550 1549 1549 1552 1554 338 340 342 341 956 958 960 302 304 303 303 306 746 745 748 747 747 750 749 356 355 355 358 357 360 359 1478 1477 1477 1480 1482 1580 1582 1584 782 781 784 783 783 783 783 786 785 785 1586 1585 1585 1585 1588 1587 1590 1589 1010 1009 1012 1014 1013 1013 2036 2038 2037 2037 2037 2040 2039 2039 302 301 301 304 303 306 1388 1390 1392 1391 998 1000 999 1002 1001 1001 1001 1700 1699 1699 1699 1699 1702 1701 1704 1703 1118 1117 1117 1117 1117 1117 1120 1119 1119 1122 1196 1198 1200 1454 1453 1453 1453 1456 1455 1455 1458 482 484 483 483 483 486 485 485 485 485 485 485 1964 1966 1968 1967 1967 1967 1967 1967 1967 4 1 1 1 1 1 16 15 15 15 15 15 15 15 15 15 15 15 15 15 18
103-1241-0019 4 1 1 16 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 18 17 17 17 17 17 17 17 17 584 583 583 586 585 585 588 587 1838 1837 1837 1840 1839 1842 1841 1922 1924 1926 1925 956 955 958 960 1454 1456 1455 1455 1455 1455 1458 1457 746 748 747 747 747 750 956 958 960 1574 1573 1573 1573 1573 1576 1578 1628 1627 1627 1627 1630 1629 1632 1454 1456 1458 572 574 573 576 575 575 575 575 575 1454 1453 1453 1453 1453 1453 1456 1455 1458 1457 578 580 579 582 581 581 581 581 581 581 581 581 581 581 338 340 342 956 958 960 959 959 959 959 4 16 15 15 15 15 15 15 15 15 15 15 15 15 18 17 17 17 17 1478 1477 1480 1482 1481 1562 1564 1566 308 310 312 1382 1384 1383 1386 1385 1124 1123 1123 1126 1128 374 376 375 378 260 259 262 264 263 950 952 951 951 954 1418 1417 1420 1419 1419 1422 1421 962 964 966 965 965 1562 1564 1566 332 334 336 335 335 350 352 354 353 353 353 353 353 353 353 1586 1585 1588 1590 1460 1459 1462 1461 1461 1461 1464 1118 1120 1119 1119 1119 1119 1122 1121 1196 1198 1200 1454 1453 1453 1456 1455 1458 2060 2059 2062 2061 2064 2063 302 301 301 304 303 303 306 1388 1390 1392 326 328 327 330 329 329 329 329 578 577 580 579 579 579 579 582 581 581 581 581 581 581 581 581 581 308 307 307 307 310 312 311 4 1 16 15 15 15 15 15 18

>> show-transitions data/lang/phones.txt exp/mono/0.mdl | head -n 10
show-transitions data/lang/phones.txt exp/mono/0.mdl
Transition-state 1: phone = SIL hmm-state = 0 pdf = 0
 Transition-id = 1 p = 0.25 [self-loop]
 Transition-id = 2 p = 0.25 [0 -> 1]
 Transition-id = 3 p = 0.25 [0 -> 2]
 Transition-id = 4 p = 0.25 [0 -> 3]
Transition-state 2: phone = SIL hmm-state = 1 pdf = 1
 Transition-id = 5 p = 0.25 [self-loop]
 Transition-id = 6 p = 0.25 [1 -> 2]
 Transition-id = 7 p = 0.25 [1 -> 3]
 Transition-id = 8 p = 0.25 [1 -> 4]

>> show-alignments data/lang/phones.txt exp/mono/0.mdl "ark:gunzip -c exp/mono/ali.1.gz |" | head -n 4
show-alignments data/lang/phones.txt exp/mono/0.mdl 'ark:gunzip -c exp/mono/ali.1.gz |'
103-1240-0015  [ 4 1 1 1 1 1 1 1 1 16 15 15 18 17 17 17 17 17 17 17 ] [ 1382 1381 1384 1386 ] [ 1124 1123 1123 1126 1128 ] [ 1838 1840 1842 ] [ 2066 2065 2068 2067 2067 2070 2069 2069 2069 2069 ] [ 956 958 960 ] [ 1958 1957 1960 1959 1962 1961 ] [ 1586 1585 1585 1585 1588 1590 ] [ 332 334 333 336 335 ] [ 1790 1789 1789 1789 1789 1789 1789 1789 1792 1791 1794 ] [ 308 310 312 ] [ 1550 1552 1554 ] [ 1148 1150 1152 1151 1151 1151 ] [ 302 301 301 304 303 303 303 306 305 305 305 ] [ 1226 1225 1228 1227 1227 1227 1230 ] [ 338 340 342 341 341 ] [ 1562 1564 1563 1566 1565 ] [ 1628 1627 1630 1632 ] [ 182 181 181 181 181 181 181 181 181 184 183 183 186 ] [ 2066 2065 2065 2068 2067 2067 2067 2067 2067 2067 2070 ] [ 956 958 960 ] [ 1838 1837 1840 1839 1842 ] [ 2060 2059 2062 2061 2064 2063 2063 ] [ 638 637 640 639 639 639 642 641 ] [ 1082 1084 1086 ] [ 962 964 966 965 ] [ 1562 1564 1566 ] [ 338 337 337 340 342 ] [ 308 310 312 ] [ 950 952 954 953 ] [ 1970 1972 1971 1974 ] [ 2162 2161 2164 2166 2165 2165 ] [ 188 187 187 187 187 190 189 192 191 191 ] [ 1574 1573 1573 1573 1576 1578 1577 ] [ 1628 1627 1630 1629 1629 1632 ] [ 1550 1549 1549 1552 1554 ] [ 338 340 342 341 ] [ 956 958 960 ] [ 302 304 303 303 306 ] [ 746 745 748 747 747 750 749 ] [ 356 355 355 358 357 360 359 ] [ 1478 1477 1477 1480 1482 ] [ 1580 1582 1584 ] [ 782 781 784 783 783 783 783 786 785 785 ] [ 1586 1585 1585 1585 1588 1587 1590 1589 ] [ 1010 1009 1012 1014 1013 1013 ] [ 2036 2038 2037 2037 2037 2040 2039 2039 ] [ 302 301 301 304 303 306 ] [ 1388 1390 1392 1391 ] [ 998 1000 999 1002 1001 1001 1001 ] [ 1700 1699 1699 1699 1699 1702 1701 1704 1703 ] [ 1118 1117 1117 1117 1117 1117 1120 1119 1119 1122 ] [ 1196 1198 1200 ] [ 1454 1453 1453 1453 1456 1455 1455 1458 ] [ 482 484 483 483 483 486 485 485 485 485 485 485 ] [ 1964 1966 1968 1967 1967 1967 1967 1967 1967 ] [ 4 1 1 1 1 1 16 15 15 15 15 15 15 15 15 15 15 15 15 15 18 ]
103-1240-0015  SIL                                                    IH0_B                   F_E                          HH_B               IY1_I                                                 D_E             R_B                               AH1_I                             N_E                     AW1_B                                                      T_E             AH0_B              V_E                               T_B                                             ER1_I                                  N_I                     AH0_I                        P_E                     S_B                                                     IY1_I                                                      D_E             HH_B                         IY1_E                                  W_B                                 UH1_I              D_I                 AH0_I              N_I                     T_E             D_B                 R_I                     EH1_I                             S_E                                         AH1_B                                  P_E                               AH0_B                        N_I                 D_E             T_B                     EY1_I                           K_E                             DH_B                         AH1_E              B_B                                         AH1_I                                       G_I                               IY0_E                                       T_B                         IH0_E                   G_B                                  OW1_E                                            F_B                                                   ER0_E              M_B                                         AO1_I                                               R_E                                              SIL

103-1241-0019  [ 4 1 1 16 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 18 17 17 17 17 17 17 17 17 ] [ 584 583 583 586 585 585 588 587 ] [ 1838 1837 1837 1840 1839 1842 1841 ] [ 1922 1924 1926 1925 ] [ 956 955 958 960 ] [ 1454 1456 1455 1455 1455 1455 1458 1457 ] [ 746 748 747 747 747 750 ] [ 956 958 960 ] [ 1574 1573 1573 1573 1573 1576 1578 ] [ 1628 1627 1627 1627 1630 1629 1632 ] [ 1454 1456 1458 ] [ 572 574 573 576 575 575 575 575 575 ] [ 1454 1453 1453 1453 1453 1453 1456 1455 1458 1457 ] [ 578 580 579 582 581 581 581 581 581 581 581 581 581 581 ] [ 338 340 342 ] [ 956 958 960 959 959 959 959 ] [ 4 16 15 15 15 15 15 15 15 15 15 15 15 15 18 17 17 17 17 ] [ 1478 1477 1480 1482 1481 ] [ 1562 1564 1566 ] [ 308 310 312 ] [ 1382 1384 1383 1386 1385 ] [ 1124 1123 1123 1126 1128 ] [ 374 376 375 378 ] [ 260 259 262 264 263 ] [ 950 952 951 951 954 ] [ 1418 1417 1420 1419 1419 1422 1421 ] [ 962 964 966 965 965 ] [ 1562 1564 1566 ] [ 332 334 336 335 335 ] [ 350 352 354 353 353 353 353 353 353 353 ] [ 1586 1585 1588 1590 ] [ 1460 1459 1462 1461 1461 1461 1464 ] [ 1118 1120 1119 1119 1119 1119 1122 1121 ] [ 1196 1198 1200 ] [ 1454 1453 1453 1456 1455 1458 ] [ 2060 2059 2062 2061 2064 2063 ] [ 302 301 301 304 303 303 306 ] [ 1388 1390 1392 ] [ 326 328 327 330 329 329 329 329 ] [ 578 577 580 579 579 579 579 582 581 581 581 581 581 581 581 581 581 ] [ 308 307 307 307 310 312 311 ] [ 4 1 16 15 15 15 15 15 18 ]

>> utils/int2sym.pl -f 2- data/lang/words.txt exp/mono/decode_nosp_tgsmall_test_clean/scoring/7.0.0.tra| head -n 3
1089-134686-0000 HE HOPED THERE WOULD BE STEW FOR DINNER TURNIPS AND CARROTS AND BRUISED POTATOES AND FATMA AND PIECES TO BE LADLED OUT IN THICK PEPPERED FLOWER FATHOM SAUCE
1089-134686-0001 STUFF DIDN'T YOU HIS BELLY COUNTED THEM
1089-134686-0002 AFTER EARLY NIGHTFALL THE ALLIANCE WOULD LIGHT UP HERE AND THERE THE SQUALID QUARTER OF THE BROTHELS

>> utils/int2sym.pl -f 2- data/lang/words.txt exp/mono/decode_nosp_tgsmall_test_clean/scoring/7.0.0.tra| head -n 3 | utils/sym2int.pl -f 2- data/lang/words.txt
1089-134686-0000 78818 82744 176144 197114 13845 168273 64424 47589 182468 5411 27404 5411 22871 138098 5411 60568 5411 134500 178313 13845 97990 127347 86219 176327 132304 63760 60543 154644
1089-134686-0001 169785 47115 198712 81505 15137 38747 175984
1089-134686-0002 2191 52770 121894 175861 3891 197114 101964 186768 80190 5411 176144 175861 166824 142471 124782 175861 22700

```

### Lattice
The lattice (i.e. [CompactLattice type known in FSA, acceptor, format, with an arc format](http://codingandlearning.blogspot.com/2014/01/kaldi-lattices.html)) is formed as follows:

[start state id] [end state id] [input & output symbol] [weight]

The input/output symbol are usually the word ids and the weight is:

[the graph cost],[the acoustic cost],[a string sequence of integers - transition ids]

The integers represent the transition ids, i.e. the frame-alignment for this word symbol.


```
>> lattice-copy "ark:gunzip -c exp/mono/decode_nosp_tgsmall_test_clean/lat.1.gz|" ark,t:- | utils/int2sym.pl -f 3 data/lang_nosp/words.txt | head -10
lattice-copy 'ark:gunzip -c exp/mono/decode_nosp_tgsmall_test_clean/lat.1.gz|' ark,t:-
1089-134686-0000
0 1 HE 9.12696,5837.53,4_1_1_1_1_1_1_16_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_18_17_17_17_17_17_1838_1840_1839_1842_2060_2059_2059_2059_2062_2061_2064
0 196 THE 17.022,8215.73,4_1_1_1_1_1_1_16_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_18_17_17_17_17_1478_1480_1482_1481_2036_2035_2035_2035_2035_2038_2037_2040_2039_2039_2039_1838_1837_1840_1842_1706_1705_1705_1705_1705_1705_1708_1707_1707_1707_1707_1710_1634_1633_1633_1633_1636_1635_1638
0 212 THEY 16.0285,7389.03,4_1_1_1_1_1_1_16_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_18_17_17_17_17_1478_1480_1482_1481_740_739_739_742_744_743_743_743_743_743_1838_1837_1837_1840_1842_1706_1705_1705_1705_1705_1705_1708_1707_1707_1707
0 302 SHE 17.0534,8358.78,4_1_1_1_1_1_1_16_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_15_18_17_17_17_17_17_614_616_618_2060_2059_2059_2059_2059_2062_2061_2064_2063_2063_2063_1838_1837_1840_1842_1706_1705_1705_1705_1705_1705_1708_1707_1707_1707_1707_1710_1634_1633_1633_1633_1636_1635_1638_1637
1 2 HOPED 9.31398,3645.34,2063_2063_2063_1838_1837_1840_1842_1706_1705_1705_1705_1705_1705_1708_1707_1707_1707_1707_1710_1634_1633_1633_1633_1636_1635_1638_1637_308_307_307_310
2 3 THERE 5.06083,843.538,
2 60 THEY 3.9055,600.173,309_312_1478_1477_1477_1477_1480_1482_740_739_742_744
2 186 IT 4.3805,2018.23,309_309_312_311_311_311_311_311_1382_1381_1384_1386_308_310_312_638_637_637_637_637_637_640_639_639_642
3 4 WOULD 1.94562,1761.93,309_312_1478_1477_1477_1477_1480_1482_2162_2161_2164_2166_1964_1966_1968_638_637_637_637_637_637_640_639_639_642_1082_1084
```


